---
title: "Untitled"
format: html
---

## ANALYSIS OF OLINK DATA OF MONOCYTE SBSETS AT BASELINE AND 24HR AFTER ECOLI INFECTION
### proteins from serum of classical, intermediate and non-classical monos measured in 1 patient
```{r}
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)
library(RColorBrewer)
```

### load in data and keep only relevant columns
### remove the 6 proteins with QC warnings
### remove the prefix from the sample_id column
### add subset and time columns
```{r}
df <- read_xlsx("Olink_fulldata.xlsx")
df <- df[, c(1,8,12,13,14,17)]
df <- filter(df, AssayQC %in% "PASS")
df$SampleID <- sub("AL_", "", x = df$SampleID)
df <- df %>% separate(SampleID, into = c("subset", "time"), sep = "_", remove = F)
```

## plot expression in IM vs CM at 24 hours

```{r}
plot_input <- filter(df, time == "24h")
plot_input <- plot_input[, c(2,4,5)]
plot_input <- pivot_wider(plot_input, names_from = "subset", values_from = "Count")
plot_input <- plot_input %>%
  mutate(deviation = log(IM) - log(CM))
ggplot(plot_input, aes(x = log(IM), y = log(CM), fill = deviation))+
    geom_point(shape = 21, colour = "black")+
    geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "black")+
    xlim(0, max(log(plot_input$IM+1)))+ylim(0,max(log(plot_input$CM+1)))+
    theme_bw()+scale_fill_viridis_c()
```